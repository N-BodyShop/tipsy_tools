subproject base ;

import python ;

import ../simanrules ;


dll siman :
	transformation.cpp simanarray.cpp simanvec.cpp
 	glew.c config.cpp visualiser.cpp glutinterface.cpp colourmap.cpp
	basesimsnap.cpp columngrid.cpp columnlist.cpp
	  endian.cpp filter.cpp gadgetsnap.cpp
	  grid.cpp metric.cpp particle.cpp
	  rational.cpp scripted.cpp siman.cpp simanexception.cpp
           simsnap.cpp sphkernel.cpp subset.cpp
          tipsysnap.cpp union.cpp units.cpp 
	glutinterfaceautomated.cpp annotate.cpp
	
	<dll>@boost/libs/python/build/boost_python
	<lib>@boost/libs/filesystem/build/boost_filesystem	
	$(EXTRA_SIMAN)
:
	<dllversion>0.10.0
	<define>SIMAN_COMPILING_LIBRARY=1
	$(EXTRA_SIMAN_DEF)
	$(PYTHON_PROPERTIES)
	<library-path>$(PYTHON_LIB_PATH)
	<find-library>$(PYTHON_EMBEDDED_LIBRARY)
	$(LIBRARY_ADD)
	<tag><debug>"_debug"
	;

stage lib : <dll>siman
	: 
	  <locate>$(SIMAN_LOCATE)
	: release ;

stage "include/siman/base" : [ GLOB $(TOP)/base/ : *.h* ] 
	: <locate>$(SIMAN_LOCATE) ;

stage "include/siman/extra" : [ GLOB $(TOP)/extra/ : *.h* ]
	: <locate>$(SIMAN_LOCATE) ; 

stage "include/siman" : [ GLOB $(TOP) : base.hpp extra.hpp ] 
	: <locate>$(SIMAN_LOCATE) ;

install siman lib :
	<dll>siman ;
